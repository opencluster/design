Locks Client Protocol

### Client to Server Commands

```
// 1 byte integer - 0x0000 to 0x0fff         0 000 xxxx xxxx
// 2 byte integer - 0x1000 to 0x1fff         0 001 xxxx xxxx

0x1000	CAPABILITY <command-id>
		This command asks the service if it supports a specific command.  It's parameter is a 16-bit command.   Can be used by both server and client.
		Responds with:
			OK_COMMAND <command-id>
			INVALID_COMMAND <command-id>
			
0x1001	OK_COMMAND <command-id>
		When a client or server wants to know if particular commands are supported, it will ask 'CAPABILITY <command-id>'.  If the command is supported by the server, it will respond with this OK_COMMAND.   
		
0x1002	INVALID_COMMAND <command-id>
		If an invalid command is received by the client or servver, it will respond with this command.  Both client and server need to ensure that services are handled correctly if this result is received.  It typically means that either protocol is out-of-date.   To verify the capability of the opposite connection to be able to handle the commands expected prior to actually using them, see the CAPABILITY command.


// 4 byte integer - 0x2000 to 0x2fff         0 010 xxxx xxxx

0x2000	EXPIRE_SECONDS <seconds>
		Used when a lock is being set an expiry can be set.  This is a failsafe, and is recommended not to use.

// 8 byte integer - 0x3000 to 0x3fff         0 011 xxxx xxxx

0x3000	UNLOCK_CODE <code>
		This is a random 64-bit number that is generated by the server and provided to the client when a Lock is set.   In order to unlock the lock, the same Unlock-Code must be supplied.
		
0x3000	LOCK_WAIT_TIMEOUT <seconds>
		When LOCK_WAIT is used, it will wait for 'seconds' before returning a failure.   This feature can be used in situations where a single-threaded client needs to try for the lock, but if it cant get it within a certain time, needs to provide some other functionality before trying again.   This value will remain for the session, not just the single attempt.  Setting 'seconds' to zero means that it will wait forever.

// 16 byte integer - 0x4000 to 0x4fff        0 100 xxxx xxxx
// 32 byte integer - 0x5000 to 0x5fff        0 101 xxxx xxxx
// 64 byte integer - 0x6000 to 0x6fff        0 110 xxxx xxxx
// No Parameters - 0x7000 to 0x7fff          0 111 xxxx xxxx

0x7000	SET_LOCK
		Will use the NAME and EXPIRE_SECONDS values to determine what to do.
		
0x7001	SET_LOCK_WAIT
		Will attempt to set a Lock, and will wait until LOCK_WAIT_TIMEOUT seconds before exiting.
		
0x7002	LOCKED
		Will provide the LOCK_NAME, EXPIRE_SECONDS, UNLOCK_CODE of a lock that has been set.
		
0x7003	LOCK_FAILED
		Will provide the LOCK_NAME of the failed lock.   Lock can fail immediately if SET_LOCK was used, or after the timeout period if SET_LOCK_WAIT was used.

// 1 byte-length string - 0x8000 to 0x8fff   1 000 xxxx xxxx
// 2 byte-length string - 0x9000 to 0x9fff   1 001 xxxx xxxx

0x9000	USERNAME <username>
		Used for authentication components.  Normally is used to establish a client certificate.
		
0x9001	PASSWORD <password>
		Used for authentication componenets.
		
0x9002	CSR <csr>
		Client can generate a CSR and ask it to be signed by the CA for the Locks service (zone specific).
		
0x9003	ZONE <zone>
		The zone name is a specific isolated tenented zone.  The user must be authenticated for the zone to allow access to anything.
		
0x9004	LOCATION_DOMAIN <>
		The location domain indicates physical or logical properties that can allow grouping of services.  For example, the client can indicate what country and city it is in, and the Locks service can provide appropriate connection details to a service that is more appropriate for that location.

0x9005	LOCK_NAME <>
		The lock name.
		
0x9006	SERVER_NAME <>
		When servers are connecting to each other, they can provide their configured names.  This can make it easier to debug and manage.
		
0x9007	CLIENT_NAME <>
		When a client connects, it can provide a client name.  Server can be configured in multiple ways, to restrict the connections, or allow them.

		
		
// 4 byte-length string - 0xa000 to 0xafff   1 010 xxxx xxxx
// 8 byte-length string - 0xb000 to 0xbfff   1 011 xxxx xxxx
// No Parameters - 0xc000 to 0xffff          1 1xx xxxx xxxx

```
